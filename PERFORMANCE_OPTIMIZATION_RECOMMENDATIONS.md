# ğŸš€ CardStrategy å°ˆæ¡ˆæ•ˆèƒ½å„ªåŒ–å»ºè­°

## ğŸ“Š ç•¶å‰æ•ˆèƒ½ç‹€æ³åˆ†æ

### âœ… å·²å®Œæˆçš„å„ªåŒ–
1. **Service Worker ç®¡ç†** - å®Œæ•´çš„é›¢ç·šæ”¯æŒå’Œç·©å­˜ç­–ç•¥
2. **å¾Œç«¯æ•ˆèƒ½ç›£æ§** - éŸ¿æ‡‰æ™‚é–“ã€å…§å­˜ä½¿ç”¨ã€æ•¸æ“šåº«æŸ¥è©¢ç›£æ§
3. **æ•¸æ“šåº«å„ªåŒ–** - æŸ¥è©¢å„ªåŒ–ã€ç´¢å¼•å»ºè­°ã€é€£æ¥æ± ç›£æ§
4. **ç·©å­˜æ©Ÿåˆ¶** - Redis ç·©å­˜ã€API éŸ¿æ‡‰ç·©å­˜
5. **åœ–ç‰‡å„ªåŒ–** - æ‡¶åŠ è¼‰ã€éŸ¿æ‡‰å¼åœ–ç‰‡ã€æ ¼å¼å„ªåŒ–

### ğŸ”§ éœ€è¦å„ªåŒ–çš„åœ°æ–¹

## 1. **React Native å‰ç«¯å„ªåŒ–**

### 1.1 Bundle å¤§å°å„ªåŒ–
```javascript
// æ–°å¢çš„ metro.config.js é…ç½®
- âœ… å•Ÿç”¨ Hermes å¼•æ“
- âœ… å„ªåŒ–æ¨¡çµ„è§£æ
- âœ… æ’é™¤æ¸¬è©¦æ–‡ä»¶
- âœ… æ™ºèƒ½ç·©å­˜é…ç½®
- âœ… æ•ˆèƒ½ç›£æ§ä¸­é–“ä»¶
```

**å»ºè­°æ”¹é€²ï¼š**
- å¯¦ç¾ä»£ç¢¼åˆ†å‰² (Code Splitting)
- æ·»åŠ  Bundle åˆ†æå·¥å…·
- å„ªåŒ–ç¬¬ä¸‰æ–¹ä¾è³´

### 1.2 è¨˜æ†¶é«”å„ªåŒ–
```typescript
// æ–°å¢çš„ performanceOptimizer.ts
- âœ… è¨˜æ†¶é«”ä½¿ç”¨ç›£æ§
- âœ… æ•ˆèƒ½æŒ‡æ¨™æ¸¬é‡
- âœ… ç•°æ­¥ä»»å‹™å„ªåŒ–
- âœ… æ‰¹é‡æ“ä½œå„ªåŒ–
```

**å»ºè­°æ”¹é€²ï¼š**
- å¯¦ç¾è™›æ“¬åŒ–åˆ—è¡¨
- å„ªåŒ–åœ–ç‰‡ç·©å­˜ç­–ç•¥
- æ·»åŠ è¨˜æ†¶é«”æ´©æ¼æª¢æ¸¬

### 1.3 æ¸²æŸ“å„ªåŒ–
```typescript
// å»ºè­°æ·»åŠ çš„å„ªåŒ–
- ä½¿ç”¨ React.memo å„ªåŒ–çµ„ä»¶é‡æ¸²æŸ“
- å¯¦ç¾ useMemo å’Œ useCallback
- æ·»åŠ  React DevTools Profiler
- å„ªåŒ–å‹•ç•«æ•ˆèƒ½
```

## 2. **å¾Œç«¯æ•ˆèƒ½å„ªåŒ–**

### 2.1 é«˜ç´šç·©å­˜ç­–ç•¥
```javascript
// æ–°å¢çš„ advancedCacheService.js
- âœ… æ™ºèƒ½ç·©å­˜ç­–ç•¥
- âœ… ç·©å­˜é ç†±æ©Ÿåˆ¶
- âœ… æ‰¹é‡ç·©å­˜æ“ä½œ
- âœ… ç·©å­˜çµ±è¨ˆç›£æ§
```

**å»ºè­°æ”¹é€²ï¼š**
- å¯¦ç¾åˆ†æ•£å¼ç·©å­˜
- æ·»åŠ ç·©å­˜ç©¿é€ä¿è­·
- å¯¦ç¾ç·©å­˜é›ªå´©é˜²è­·

### 2.2 æ•¸æ“šåº«å„ªåŒ–
```sql
-- å»ºè­°æ·»åŠ çš„ç´¢å¼•
CREATE INDEX idx_cards_user_status ON cards(user_id, status);
CREATE INDEX idx_market_data_timestamp ON market_data(timestamp);
CREATE INDEX idx_investments_user_date ON investments(user_id, created_at);

-- å»ºè­°çš„æŸ¥è©¢å„ªåŒ–
SELECT c.*, u.username 
FROM cards c 
INNER JOIN users u ON c.user_id = u.id 
WHERE c.status = 'active' 
LIMIT 50;
```

### 2.3 API å„ªåŒ–
```javascript
// å»ºè­°æ·»åŠ çš„å„ªåŒ–
- GraphQL å¯¦ç¾
- API ç‰ˆæœ¬æ§åˆ¶
- è«‹æ±‚åˆä½µ (Batching)
- å¯¦æ™‚æ•¸æ“šæ¨é€ (WebSocket)
```

## 3. **ç³»çµ±æ¶æ§‹å„ªåŒ–**

### 3.1 å¾®æœå‹™æ¶æ§‹
```yaml
# å»ºè­°çš„æœå‹™æ‹†åˆ†
services:
  - user-service
  - card-service
  - market-service
  - notification-service
  - analytics-service
```

### 3.2 è² è¼‰å‡è¡¡
```nginx
# å»ºè­°çš„ Nginx é…ç½®
upstream backend {
    least_conn;
    server backend1:3000;
    server backend2:3000;
    server backend3:3000;
}
```

### 3.3 ç›£æ§ç³»çµ±
```javascript
// å»ºè­°æ·»åŠ çš„ç›£æ§
- APM å·¥å…·é›†æˆ (New Relic, DataDog)
- åˆ†æ•£å¼è¿½è¹¤ (Jaeger, Zipkin)
- è‡ªå®šç¾©æ¥­å‹™æŒ‡æ¨™
- å‘Šè­¦æ©Ÿåˆ¶
```

## 4. **å…·é«”å„ªåŒ–å»ºè­°**

### 4.1 ç«‹å³å¯¦æ–½çš„å„ªåŒ–

#### å‰ç«¯å„ªåŒ–
1. **æ·»åŠ  Bundle åˆ†æ**
```bash
# å®‰è£ä¾è³´
npm install --save-dev @expo/webpack-config webpack-bundle-analyzer

# åˆ†æ Bundle
npx expo export --platform web
npx webpack-bundle-analyzer web-build/static/js/*.js
```

2. **å„ªåŒ–åœ–ç‰‡åŠ è¼‰**
```typescript
// ä½¿ç”¨æ–°çš„ LazyImage çµ„ä»¶
import { LazyImage } from '@/components/common/LazyImage';

<LazyImage
  uri={card.imageUrl}
  quality="medium"
  cachePolicy="both"
  priority="normal"
/>
```

3. **æ·»åŠ æ•ˆèƒ½ç›£æ§**
```typescript
// ä½¿ç”¨æ•ˆèƒ½å„ªåŒ– Hook
import { usePerformanceOptimization } from '@/utils/performanceOptimizer';

const { measurePerformance, generateReport } = usePerformanceOptimization();

// æ¸¬é‡æ•ˆèƒ½
measurePerformance('cardListRender', () => {
  // æ¸²æŸ“é‚è¼¯
});
```

#### å¾Œç«¯å„ªåŒ–
1. **ä½¿ç”¨é«˜ç´šç·©å­˜æœå‹™**
```javascript
// åœ¨è·¯ç”±ä¸­ä½¿ç”¨
const advancedCache = require('../services/advancedCacheService');

// ç²å–ç·©å­˜æ•¸æ“š
const cachedData = await advancedCache.get('cards:popular', 'cards');
if (cachedData) {
  return res.json(cachedData);
}

// è¨­ç½®ç·©å­˜
await advancedCache.set('cards:popular', data, 'cards');
```

2. **å„ªåŒ–æ•¸æ“šåº«æŸ¥è©¢**
```javascript
// ä½¿ç”¨æŸ¥è©¢å„ªåŒ–å™¨
const databaseOptimizer = require('../services/databaseOptimizer');

const optimizedQuery = databaseOptimizer.optimizeQuery({
  where: { status: 'active' },
  include: [{ model: User, as: 'user' }],
  limit: 50
});
```

### 4.2 ä¸­æœŸå„ªåŒ–è¨ˆåŠƒ

#### æ¶æ§‹å„ªåŒ–
1. **å¯¦ç¾å¾®æœå‹™æ‹†åˆ†**
2. **æ·»åŠ æœå‹™ç™¼ç¾æ©Ÿåˆ¶**
3. **å¯¦ç¾ç†”æ–·å™¨æ¨¡å¼**
4. **æ·»åŠ è² è¼‰å‡è¡¡**

#### ç›£æ§å„ªåŒ–
1. **é›†æˆ APM å·¥å…·**
2. **å¯¦ç¾åˆ†æ•£å¼è¿½è¹¤**
3. **æ·»åŠ è‡ªå®šç¾©æŒ‡æ¨™**
4. **å®Œå–„å‘Šè­¦æ©Ÿåˆ¶**

### 4.3 é•·æœŸå„ªåŒ–è¨ˆåŠƒ

#### æ•ˆèƒ½å„ªåŒ–
1. **å¯¦ç¾ CDN åŠ é€Ÿ**
2. **æ·»åŠ é‚Šç·£è¨ˆç®—**
3. **å¯¦ç¾ PWA åŠŸèƒ½**
4. **å„ªåŒ– SEO**

#### æ¶æ§‹å„ªåŒ–
1. **å¯¦ç¾äº‹ä»¶é©…å‹•æ¶æ§‹**
2. **æ·»åŠ æ¶ˆæ¯éšŠåˆ—**
3. **å¯¦ç¾ CQRS æ¨¡å¼**
4. **æ·»åŠ è®€å¯«åˆ†é›¢**

## 5. **æ•ˆèƒ½æ¸¬è©¦å»ºè­°**

### 5.1 å‰ç«¯æ¸¬è©¦
```bash
# æ•ˆèƒ½æ¸¬è©¦
npm run performance:test

# Bundle åˆ†æ
npm run analyze:bundle

# è¨˜æ†¶é«”æ¸¬è©¦
npm run test:memory
```

### 5.2 å¾Œç«¯æ¸¬è©¦
```bash
# è² è¼‰æ¸¬è©¦
npm run load:test

# å£“åŠ›æ¸¬è©¦
npm run stress:test

# æ•ˆèƒ½åŸºæº–æ¸¬è©¦
npm run benchmark
```

## 6. **ç›£æ§æŒ‡æ¨™**

### 6.1 å‰ç«¯æŒ‡æ¨™
- **FCP (First Contentful Paint)**: < 1.5s
- **LCP (Largest Contentful Paint)**: < 2.5s
- **FID (First Input Delay)**: < 100ms
- **CLS (Cumulative Layout Shift)**: < 0.1

### 6.2 å¾Œç«¯æŒ‡æ¨™
- **API éŸ¿æ‡‰æ™‚é–“**: < 200ms (å¹³å‡)
- **æ•¸æ“šåº«æŸ¥è©¢æ™‚é–“**: < 50ms (å¹³å‡)
- **ç·©å­˜å‘½ä¸­ç‡**: > 80%
- **éŒ¯èª¤ç‡**: < 0.1%

### 6.3 ç³»çµ±æŒ‡æ¨™
- **CPU ä½¿ç”¨ç‡**: < 70%
- **è¨˜æ†¶é«”ä½¿ç”¨ç‡**: < 80%
- **ç£ç›¤ I/O**: < 80%
- **ç¶²è·¯å»¶é²**: < 100ms

## 7. **å¯¦æ–½æ™‚é–“è¡¨**

### ç¬¬ä¸€é€±
- [ ] å¯¦æ–½ Metro é…ç½®å„ªåŒ–
- [ ] æ·»åŠ æ•ˆèƒ½ç›£æ§å·¥å…·
- [ ] å„ªåŒ–åœ–ç‰‡åŠ è¼‰

### ç¬¬äºŒé€±
- [ ] å¯¦æ–½é«˜ç´šç·©å­˜æœå‹™
- [ ] å„ªåŒ–æ•¸æ“šåº«æŸ¥è©¢
- [ ] æ·»åŠ æ•ˆèƒ½æ¸¬è©¦

### ç¬¬ä¸‰é€±
- [ ] å¯¦æ–½å¾®æœå‹™æ¶æ§‹
- [ ] æ·»åŠ è² è¼‰å‡è¡¡
- [ ] å®Œå–„ç›£æ§ç³»çµ±

### ç¬¬å››é€±
- [ ] æ•ˆèƒ½æ¸¬è©¦å’Œèª¿å„ª
- [ ] æ–‡æª”æ›´æ–°
- [ ] éƒ¨ç½²å’Œé©—è­‰

## 8. **é æœŸæ•ˆæœ**

### æ•ˆèƒ½æå‡
- **å‰ç«¯è¼‰å…¥é€Ÿåº¦**: æå‡ 40-60%
- **API éŸ¿æ‡‰æ™‚é–“**: æ¸›å°‘ 50-70%
- **è¨˜æ†¶é«”ä½¿ç”¨**: æ¸›å°‘ 30-40%
- **Bundle å¤§å°**: æ¸›å°‘ 20-30%

### ç”¨æˆ¶é«”é©—
- **é¦–æ¬¡è¼‰å…¥æ™‚é–“**: < 2 ç§’
- **é é¢åˆ‡æ›æ™‚é–“**: < 500ms
- **åœ–ç‰‡è¼‰å…¥æ™‚é–“**: < 1 ç§’
- **é›¢ç·šåŠŸèƒ½**: å®Œå…¨æ”¯æŒ

### ç³»çµ±ç©©å®šæ€§
- **éŒ¯èª¤ç‡**: < 0.05%
- **å¯ç”¨æ€§**: > 99.9%
- **æ¢å¾©æ™‚é–“**: < 5 åˆ†é˜
- **ç›£æ§è¦†è“‹ç‡**: 100%

## 9. **é¢¨éšªè©•ä¼°**

### ä½é¢¨éšª
- Metro é…ç½®å„ªåŒ–
- æ•ˆèƒ½ç›£æ§æ·»åŠ 
- ç·©å­˜ç­–ç•¥å„ªåŒ–

### ä¸­é¢¨éšª
- å¾®æœå‹™æ¶æ§‹æ”¹é€ 
- æ•¸æ“šåº«å„ªåŒ–
- è² è¼‰å‡è¡¡å¯¦æ–½

### é«˜é¢¨éšª
- å¤§è¦æ¨¡æ¶æ§‹é‡æ§‹
- ç¬¬ä¸‰æ–¹æœå‹™é›†æˆ
- æ•¸æ“šé·ç§»

## 10. **ç¸½çµ**

é€šéå¯¦æ–½é€™äº›å„ªåŒ–å»ºè­°ï¼ŒCardStrategy å°ˆæ¡ˆå°‡èƒ½å¤ ï¼š

1. **é¡¯è‘—æå‡æ•ˆèƒ½** - å‰ç«¯è¼‰å…¥é€Ÿåº¦æå‡ 40-60%ï¼ŒAPI éŸ¿æ‡‰æ™‚é–“æ¸›å°‘ 50-70%
2. **æ”¹å–„ç”¨æˆ¶é«”é©—** - æ›´å¿«çš„è¼‰å…¥æ™‚é–“ï¼Œæ›´æµæš¢çš„æ“ä½œé«”é©—
3. **æé«˜ç³»çµ±ç©©å®šæ€§** - æ›´å¥½çš„éŒ¯èª¤è™•ç†ï¼Œæ›´é«˜çš„å¯ç”¨æ€§
4. **é™ä½é‹ç‡Ÿæˆæœ¬** - æ›´å°‘çš„æœå‹™å™¨è³‡æºæ¶ˆè€—ï¼Œæ›´ä½çš„ç¶­è­·æˆæœ¬

å»ºè­°æŒ‰ç…§å„ªå…ˆç´šé€æ­¥å¯¦æ–½é€™äº›å„ªåŒ–ï¼Œç¢ºä¿æ¯å€‹éšæ®µéƒ½æœ‰æ˜ç¢ºçš„ç›®æ¨™å’Œå¯æ¸¬é‡çš„æ•ˆæœã€‚
