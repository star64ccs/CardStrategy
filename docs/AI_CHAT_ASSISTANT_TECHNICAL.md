# AIèŠå¤©åŠ©æ‰‹æŠ€è¡“æ–‡æª”

## ğŸ“‹ æ¦‚è¿°

AIèŠå¤©åŠ©æ‰‹æ˜¯CardStrategyå¹³å°çš„ç¬¬å››éšæ®µæ ¸å¿ƒåŠŸèƒ½ï¼Œæä¾›å¤šæ¨¡æ…‹è¼¸å…¥ã€æ™ºèƒ½å»ºè­°ã€æƒ…æ„Ÿåˆ†æç­‰å…ˆé€²çš„AIäº¤äº’é«”é©—ã€‚æœ¬æ–‡æª”è©³ç´°ä»‹ç´¹äº†AIèŠå¤©åŠ©æ‰‹çš„æŠ€è¡“æ¶æ§‹ã€çµ„ä»¶è¨­è¨ˆã€APIæ¥å£å’Œå¯¦ç¾ç´°ç¯€ã€‚

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### æ•´é«”æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯å±¤ (React Native)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UIçµ„ä»¶å±¤  â”‚  ç‹€æ…‹ç®¡ç†å±¤  â”‚  æœå‹™å±¤  â”‚  å·¥å…·å±¤  â”‚  é¡å‹å®šç¾©å±¤  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EnhancedAIChatBot  â”‚  Redux Store  â”‚  aiService  â”‚  utils  â”‚  types  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    å¾Œç«¯å±¤ (Node.js/Express)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  APIè·¯ç”±å±¤  â”‚  æœå‹™å±¤  â”‚  æ¨¡å‹å±¤  â”‚  æ•¸æ“šåº«å±¤  â”‚  å¤–éƒ¨APIå±¤   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  /api/ai   â”‚  aiService  â”‚  AIæ¨¡å‹  â”‚  PostgreSQL  â”‚  AIæä¾›å•†  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çµ„ä»¶æ¶æ§‹

```
EnhancedAIChatBot (ä¸»çµ„ä»¶)
â”œâ”€â”€ VoiceInputButton (èªéŸ³è¼¸å…¥)
â”œâ”€â”€ ImagePickerButton (åœ–ç‰‡é¸æ“‡)
â”œâ”€â”€ TranslationToggle (ç¿»è­¯åˆ‡æ›)
â”œâ”€â”€ EmotionIndicator (æƒ…æ„ŸæŒ‡ç¤ºå™¨)
â”œâ”€â”€ SmartSuggestions (æ™ºèƒ½å»ºè­°)
â”œâ”€â”€ ChatSettingsModal (èŠå¤©è¨­ç½®)
â”œâ”€â”€ QuickActionsPanel (å¿«é€Ÿæ“ä½œ)
â”œâ”€â”€ ChatHistoryPanel (èŠå¤©æ­·å²)
â””â”€â”€ ContextualHelp (ä¸Šä¸‹æ–‡å¹«åŠ©)
```

## ğŸ§© æ ¸å¿ƒçµ„ä»¶è©³è§£

### 1. EnhancedAIChatBot (ä¸»çµ„ä»¶)

**æ–‡ä»¶ä½ç½®**: `src/components/ai/EnhancedAIChatBot.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- å¤šæ¨¡æ…‹è¼¸å…¥è™•ç†ï¼ˆæ–‡å­—ã€èªéŸ³ã€åœ–ç‰‡ï¼‰
- æ™ºèƒ½å»ºè­°ç³»çµ±é›†æˆ
- æƒ…æ„Ÿåˆ†æå’Œç¿»è­¯åŠŸèƒ½
- èŠå¤©è¨­ç½®å’Œæ­·å²ç®¡ç†
- éŸ¿æ‡‰å¼è¨­è¨ˆå’Œå‹•ç•«æ•ˆæœ

**ä¸»è¦Props**:
```typescript
interface EnhancedAIChatBotProps {
  displayMode?: 'full' | 'compact' | 'floating';
  onMessageSend?: (message: AIChatMessage) => void;
  onSuggestionSelect?: (suggestion: string) => void;
  onSettingsUpdate?: (settings: ChatSettings) => void;
  initialSettings?: ChatSettings;
  className?: string;
}
```

**æ ¸å¿ƒæ–¹æ³•**:
```typescript
// ç™¼é€æ¶ˆæ¯
const handleSendMessage = async (content: string, type: 'text' | 'voice' | 'image') => {
  // æ¶ˆæ¯è™•ç†é‚è¼¯
};

// ç”Ÿæˆæ™ºèƒ½å»ºè­°
const generateSuggestions = async () => {
  // å»ºè­°ç”Ÿæˆé‚è¼¯
};

// æ›´æ–°è¨­ç½®
const updateSettings = (newSettings: Partial<ChatSettings>) => {
  // è¨­ç½®æ›´æ–°é‚è¼¯
};
```

### 2. VoiceInputButton (èªéŸ³è¼¸å…¥)

**æ–‡ä»¶ä½ç½®**: `src/components/ai/VoiceInputButton.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- éº¥å…‹é¢¨æ¬Šé™ç®¡ç†
- éŒ„éŸ³ç‹€æ…‹è¦–è¦ºåé¥‹
- èªéŸ³è½‰æ–‡å­—åŠŸèƒ½
- éŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶

**ä¸»è¦Props**:
```typescript
interface VoiceInputButtonProps {
  onTranscript: (transcript: string) => void;
  isRecording?: boolean;
  disabled?: boolean;
  className?: string;
}
```

**æ ¸å¿ƒæ–¹æ³•**:
```typescript
// è«‹æ±‚éº¥å…‹é¢¨æ¬Šé™
const requestMicrophonePermission = async () => {
  // æ¬Šé™è«‹æ±‚é‚è¼¯
};

// é–‹å§‹éŒ„éŸ³
const startRecording = async () => {
  // éŒ„éŸ³é–‹å§‹é‚è¼¯
};

// åœæ­¢éŒ„éŸ³
const stopRecording = async () => {
  // éŒ„éŸ³åœæ­¢é‚è¼¯
};
```

### 3. ImagePickerButton (åœ–ç‰‡é¸æ“‡)

**æ–‡ä»¶ä½ç½®**: `src/components/ai/ImagePickerButton.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- ç›¸å†Šå’Œç›¸æ©Ÿæ¬Šé™ç®¡ç†
- åœ–ç‰‡è³ªé‡æ§åˆ¶
- å¤šç¨®åœ–ç‰‡ä¾†æºæ”¯æŒ
- åœ–ç‰‡é è™•ç†å’Œå£“ç¸®

**ä¸»è¦Props**:
```typescript
interface ImagePickerButtonProps {
  onImageSelect: (imageUri: string, base64?: string) => void;
  disabled?: boolean;
  quality?: number;
  maxWidth?: number;
  maxHeight?: number;
  className?: string;
}
```

**æ ¸å¿ƒæ–¹æ³•**:
```typescript
// å¾ç›¸å†Šé¸æ“‡åœ–ç‰‡
const pickFromGallery = async () => {
  // ç›¸å†Šé¸æ“‡é‚è¼¯
};

// ä½¿ç”¨ç›¸æ©Ÿæ‹ç…§
const takePhoto = async () => {
  // ç›¸æ©Ÿæ‹ç…§é‚è¼¯
};

// åœ–ç‰‡é è™•ç†
const preprocessImage = async (uri: string) => {
  // åœ–ç‰‡è™•ç†é‚è¼¯
};
```

### 4. TranslationToggle (ç¿»è­¯åˆ‡æ›)

**æ–‡ä»¶ä½ç½®**: `src/components/ai/TranslationToggle.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- å¤šèªè¨€æ”¯æŒï¼ˆ15ç¨®èªè¨€ï¼‰
- èªè¨€é¸æ“‡æ¨¡æ…‹æ¡†
- å¯¦æ™‚ç¿»è­¯åˆ‡æ›
- èªè¨€åå¥½è¨˜æ†¶

**æ”¯æŒçš„èªè¨€**:
```typescript
const SUPPORTED_LANGUAGES = [
  { code: 'zh-TW', name: 'ç¹é«”ä¸­æ–‡', nativeName: 'ç¹é«”ä¸­æ–‡', flag: 'ğŸ‡¹ğŸ‡¼' },
  { code: 'en', name: 'English', nativeName: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
  { code: 'ja', name: 'æ—¥æœ¬èª', nativeName: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ' },
  // ... æ›´å¤šèªè¨€
];
```

### 5. EmotionIndicator (æƒ…æ„ŸæŒ‡ç¤ºå™¨)

**æ–‡ä»¶ä½ç½®**: `src/components/ai/EmotionIndicator.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- 7ç¨®æƒ…æ„Ÿé¡å‹è­˜åˆ¥
- ç½®ä¿¡åº¦é¡¯ç¤º
- å‹•æ…‹é¡è‰²å’Œæ¨™ç±¤
- æƒ…æ„Ÿåˆ†æçµæœå¯è¦–åŒ–

**æƒ…æ„Ÿé¡å‹é…ç½®**:
```typescript
const EMOTION_CONFIGS = {
  happy: { icon: 'ğŸ˜Š', color: '#4CAF50', label: 'é–‹å¿ƒ', description: 'æ­£é¢æƒ…ç·’' },
  sad: { icon: 'ğŸ˜¢', color: '#2196F3', label: 'é›£é', description: 'è² é¢æƒ…ç·’' },
  angry: { icon: 'ğŸ˜ ', color: '#F44336', label: 'ç”Ÿæ°£', description: 'è² é¢æƒ…ç·’' },
  // ... æ›´å¤šæƒ…æ„Ÿé¡å‹
};
```

### 6. SmartSuggestions (æ™ºèƒ½å»ºè­°)

**æ–‡ä»¶ä½ç½®**: `src/components/ai/SmartSuggestions.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥å»ºè­°
- åˆ†é¡å»ºè­°ç³»çµ±
- å‹•ç•«æ•ˆæœ
- å¿«é€Ÿæ“ä½œæŒ‰éˆ•

**å»ºè­°åˆ†é¡**:
```typescript
const categorizedSuggestions = {
  'å¡ç‰‡åˆ†æ': ['åˆ†æé€™å¼µå¡ç‰‡çš„åƒ¹å€¼', 'è©•ä¼°å¡ç‰‡ç‹€æ³', 'é æ¸¬åƒ¹æ ¼è¶¨å‹¢'],
  'æŠ•è³‡å»ºè­°': ['æ¨è–¦æŠ•è³‡çµ„åˆ', 'é¢¨éšªè©•ä¼°', 'å¸‚å ´åˆ†æ'],
  'å¸‚å ´è¶¨å‹¢': ['ç•¶å‰å¸‚å ´ç‹€æ³', 'ç†±é–€å¡ç‰‡', 'åƒ¹æ ¼æ³¢å‹•'],
  'ä¸€èˆ¬å•é¡Œ': ['å¦‚ä½•ä½¿ç”¨å¹³å°', 'åŠŸèƒ½èªªæ˜', 'æŠ€è¡“æ”¯æŒ']
};
```

## ğŸ”§ æœå‹™å±¤è¨­è¨ˆ

### AIæœå‹™æ“´å±•

**æ–‡ä»¶ä½ç½®**: `src/services/aiService.ts`

**æ–°å¢æ–¹æ³•**:

#### 1. æ™ºèƒ½å»ºè­°ç”Ÿæˆ
```typescript
async generateSuggestions(lastMessage: string, context: any = {}): Promise<{ suggestions: string[] }> {
  try {
    const prompt = `åŸºæ–¼ç”¨æˆ¶çš„æœ€å¾Œä¸€æ¢æ¶ˆæ¯ï¼š"${lastMessage}"ï¼Œç”Ÿæˆ5å€‹ç›¸é—œçš„å»ºè­°å•é¡Œã€‚è¿”å›JSONæ ¼å¼ï¼š{"suggestions": ["å•é¡Œ1", "å•é¡Œ2", ...]}`;
    
    const response = await this.callAI(prompt, {
      model: 'gpt-3.5-turbo',
      maxTokens: 300,
      temperature: 0.7
    });

    // è§£æJSONéŸ¿æ‡‰
    const suggestions = this.parseSuggestionsFromResponse(response);
    return { suggestions };
  } catch (error) {
    console.error('ç”Ÿæˆå»ºè­°å¤±æ•—:', error);
    return { suggestions: this.getDefaultSuggestions() };
  }
}
```

#### 2. æƒ…æ„Ÿåˆ†æ
```typescript
async analyzeEmotion(text: string): Promise<{ emotion: string; confidence: number }> {
  try {
    const prompt = `åˆ†æä»¥ä¸‹æ–‡æœ¬çš„æƒ…æ„Ÿï¼š"${text}"ã€‚è¿”å›JSONæ ¼å¼ï¼š{"emotion": "happy|sad|angry|neutral|excited|worried|surprised", "confidence": 0.85}`;
    
    const response = await this.callAI(prompt, {
      model: 'gpt-3.5-turbo',
      maxTokens: 100,
      temperature: 0.3
    });

    const result = this.parseEmotionFromResponse(response);
    return result;
  } catch (error) {
    console.error('æƒ…æ„Ÿåˆ†æå¤±æ•—:', error);
    return { emotion: 'neutral', confidence: 0.5 };
  }
}
```

#### 3. æ–‡æœ¬ç¿»è­¯
```typescript
async translateText(text: string, targetLanguage: string): Promise<string> {
  try {
    const prompt = `å°‡ä»¥ä¸‹æ–‡æœ¬ç¿»è­¯æˆ${targetLanguage}ï¼š"${text}"ã€‚åªè¿”å›ç¿»è­¯çµæœï¼Œä¸è¦å…¶ä»–å…§å®¹ã€‚`;
    
    const response = await this.callAI(prompt, {
      model: 'gpt-3.5-turbo',
      maxTokens: 200,
      temperature: 0.3
    });

    return response.trim();
  } catch (error) {
    console.error('ç¿»è­¯å¤±æ•—:', error);
    return text; // è¿”å›åŸæ–‡
  }
}
```

#### 4. åœ–ç‰‡åˆ†æ
```typescript
async analyzeImage(imageBase64: string, prompt: string): Promise<string> {
  try {
    const response = await fetch(`${this.apiBaseUrl}/ai/analyze-image`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${this.getAuthToken()}`
      },
      body: JSON.stringify({
        image: imageBase64,
        prompt: prompt
      })
    });

    if (!response.ok) {
      throw new Error(`åœ–ç‰‡åˆ†æå¤±æ•—: ${response.status}`);
    }

    const result = await response.json();
    return result.analysis;
  } catch (error) {
    console.error('åœ–ç‰‡åˆ†æå¤±æ•—:', error);
    throw error;
  }
}
```

## ğŸ“Š ç‹€æ…‹ç®¡ç†

### Redux Store çµæ§‹

**æ–‡ä»¶ä½ç½®**: `src/store/slices/aiSlice.ts`

**ç‹€æ…‹çµæ§‹**:
```typescript
interface AIState {
  // èŠå¤©æ¶ˆæ¯
  chatMessages: AIChatMessage[];
  
  // åŠ è¼‰ç‹€æ…‹
  isLoading: boolean;
  
  // éŒ¯èª¤ä¿¡æ¯
  error: string | null;
  
  // èŠå¤©è¨­ç½®
  chatSettings: ChatSettings;
  
  // ç•¶å‰åˆ†æ
  currentAnalysis: CardAnalysis | null;
  
  // åƒ¹æ ¼é æ¸¬
  pricePrediction: PricePrediction | null;
  
  // æ™ºèƒ½å»ºè­°
  suggestions: string[];
  
  // æƒ…æ„Ÿåˆ†æ
  emotion: {
    type: string;
    confidence: number;
  } | null;
  
  // ç¿»è­¯è¨­ç½®
  translation: {
    enabled: boolean;
    targetLanguage: string;
  };
}
```

**ä¸»è¦Actions**:
```typescript
// ç™¼é€æ¶ˆæ¯
export const sendMessage = createAsyncThunk(
  'ai/sendMessage',
  async (message: AIChatMessage, { dispatch }) => {
    // æ¶ˆæ¯ç™¼é€é‚è¼¯
  }
);

// æ›´æ–°è¨­ç½®
export const updateChatSettings = createAction<Partial<ChatSettings>>('ai/updateSettings');

// ç”Ÿæˆå»ºè­°
export const generateSuggestions = createAsyncThunk(
  'ai/generateSuggestions',
  async (lastMessage: string) => {
    // å»ºè­°ç”Ÿæˆé‚è¼¯
  }
);

// åˆ†ææƒ…æ„Ÿ
export const analyzeEmotion = createAsyncThunk(
  'ai/analyzeEmotion',
  async (text: string) => {
    // æƒ…æ„Ÿåˆ†æé‚è¼¯
  }
);
```

## ğŸ”Œ API æ¥å£

### å¾Œç«¯APIè·¯ç”±

**æ–‡ä»¶ä½ç½®**: `backend/src/routes/ai.js`

**ä¸»è¦ç«¯é»**:

#### 1. èŠå¤©å°è©±
```javascript
// POST /api/ai/chat
router.post('/chat', async (req, res) => {
  try {
    const { message, context, settings } = req.body;
    const response = await aiService.processChatMessage(message, context, settings);
    res.json(response);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});
```

#### 2. åœ–ç‰‡åˆ†æ
```javascript
// POST /api/ai/analyze-image
router.post('/analyze-image', async (req, res) => {
  try {
    const { image, prompt } = req.body;
    const analysis = await aiService.analyzeImage(image, prompt);
    res.json({ analysis });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});
```

#### 3. æ™ºèƒ½å»ºè­°
```javascript
// POST /api/ai/suggestions
router.post('/suggestions', async (req, res) => {
  try {
    const { lastMessage, context } = req.body;
    const suggestions = await aiService.generateSuggestions(lastMessage, context);
    res.json({ suggestions });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});
```

#### 4. æƒ…æ„Ÿåˆ†æ
```javascript
// POST /api/ai/emotion
router.post('/emotion', async (req, res) => {
  try {
    const { text } = req.body;
    const emotion = await aiService.analyzeEmotion(text);
    res.json(emotion);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});
```

## ğŸ¨ UI/UX è¨­è¨ˆ

### è¨­è¨ˆåŸå‰‡

1. **ä¸€è‡´æ€§**: æ‰€æœ‰çµ„ä»¶éµå¾ªçµ±ä¸€çš„è¨­è¨ˆèªè¨€
2. **å¯è¨ªå•æ€§**: æ”¯æŒç„¡éšœç¤™è¨­è¨ˆå’Œéµç›¤å°èˆª
3. **éŸ¿æ‡‰å¼**: é©é…ä¸åŒå±å¹•å°ºå¯¸å’Œè¨­å‚™
4. **ç›´è§€æ€§**: ç”¨æˆ¶ç•Œé¢ç°¡æ½”æ˜äº†ï¼Œæ“ä½œæµç¨‹æ¸…æ™°

### å‹•ç•«æ•ˆæœ

```typescript
// æ‰“å­—æŒ‡ç¤ºå™¨å‹•ç•«
const typingAnimation = useSharedValue(0);

useEffect(() => {
  if (isTyping) {
    typingAnimation.value = withRepeat(
      withTiming(1, { duration: 1000 }),
      -1,
      true
    );
  } else {
    typingAnimation.value = 0;
  }
}, [isTyping]);

// å»ºè­°é¢æ¿å‹•ç•«
const suggestionsAnimation = useSharedValue(0);

const showSuggestions = () => {
  suggestionsAnimation.value = withTiming(1, { duration: 300 });
};

const hideSuggestions = () => {
  suggestionsAnimation.value = withTiming(0, { duration: 300 });
};
```

### ä¸»é¡Œæ”¯æŒ

```typescript
// ä¸»é¡Œé…ç½®
const theme = {
  colors: {
    primary: '#007AFF',
    secondary: '#5856D6',
    success: '#34C759',
    warning: '#FF9500',
    error: '#FF3B30',
    background: '#F2F2F7',
    surface: '#FFFFFF',
    text: '#000000',
    textSecondary: '#8E8E93'
  },
  spacing: {
    xs: 4,
    sm: 8,
    md: 16,
    lg: 24,
    xl: 32
  },
  borderRadius: {
    sm: 4,
    md: 8,
    lg: 12,
    xl: 16
  }
};
```

## ğŸ”’ å®‰å…¨è€ƒæ…®

### æ•¸æ“šä¿è­·

1. **è¼¸å…¥é©—è­‰**: æ‰€æœ‰ç”¨æˆ¶è¼¸å…¥éƒ½ç¶“éåš´æ ¼é©—è­‰
2. **XSSé˜²è­·**: é˜²æ­¢è·¨ç«™è…³æœ¬æ”»æ“Š
3. **CSRFé˜²è­·**: é˜²æ­¢è·¨ç«™è«‹æ±‚å½é€ 
4. **æ•¸æ“šåŠ å¯†**: æ•æ„Ÿæ•¸æ“šåŠ å¯†å­˜å„²å’Œå‚³è¼¸

### æ¬Šé™æ§åˆ¶

```typescript
// æ¬Šé™æª¢æŸ¥
const checkPermissions = async (permission: string) => {
  try {
    const { status } = await Permissions.askAsync(permission);
    return status === 'granted';
  } catch (error) {
    console.error('æ¬Šé™æª¢æŸ¥å¤±æ•—:', error);
    return false;
  }
};

// éº¥å…‹é¢¨æ¬Šé™
const microphonePermission = await checkPermissions(Permissions.AUDIO_RECORDING);

// ç›¸æ©Ÿæ¬Šé™
const cameraPermission = await checkPermissions(Permissions.CAMERA);

// ç›¸å†Šæ¬Šé™
const mediaLibraryPermission = await checkPermissions(Permissions.MEDIA_LIBRARY);
```

## ğŸ§ª æ¸¬è©¦ç­–ç•¥

### å–®å…ƒæ¸¬è©¦

```typescript
// EnhancedAIChatBot.test.tsx
describe('EnhancedAIChatBot', () => {
  it('æ‡‰è©²æ­£ç¢ºè™•ç†æ–‡æœ¬æ¶ˆæ¯ç™¼é€', async () => {
    const mockOnMessageSend = jest.fn();
    const { getByTestId } = render(
      <EnhancedAIChatBot onMessageSend={mockOnMessageSend} />
    );
    
    const input = getByTestId('message-input');
    const sendButton = getByTestId('send-button');
    
    fireEvent.changeText(input, 'æ¸¬è©¦æ¶ˆæ¯');
    fireEvent.press(sendButton);
    
    expect(mockOnMessageSend).toHaveBeenCalledWith(
      expect.objectContaining({
        content: 'æ¸¬è©¦æ¶ˆæ¯',
        type: 'text'
      })
    );
  });
});
```

### é›†æˆæ¸¬è©¦

```typescript
// aiService.test.ts
describe('AIService', () => {
  it('æ‡‰è©²æ­£ç¢ºç”Ÿæˆæ™ºèƒ½å»ºè­°', async () => {
    const aiService = new AIService();
    const result = await aiService.generateSuggestions('åˆ†æé€™å¼µå¡ç‰‡');
    
    expect(result.suggestions).toBeDefined();
    expect(Array.isArray(result.suggestions)).toBe(true);
    expect(result.suggestions.length).toBeGreaterThan(0);
  });
});
```

### ç«¯åˆ°ç«¯æ¸¬è©¦

```typescript
// ai-chat.test.js
describe('AIèŠå¤©åŠ©æ‰‹', () => {
  it('æ‡‰è©²å®Œæˆå®Œæ•´çš„èŠå¤©æµç¨‹', async () => {
    await page.goto('/ai-chat');
    
    // ç™¼é€æ¶ˆæ¯
    await page.fill('[data-testid="message-input"]', 'ä½ å¥½');
    await page.click('[data-testid="send-button"]');
    
    // ç­‰å¾…AIéŸ¿æ‡‰
    await page.waitForSelector('[data-testid="ai-response"]');
    
    // é©—è­‰éŸ¿æ‡‰
    const response = await page.textContent('[data-testid="ai-response"]');
    expect(response).toBeTruthy();
  });
});
```

## ğŸ“ˆ æ€§èƒ½å„ªåŒ–

### å‰ç«¯å„ªåŒ–

1. **çµ„ä»¶æ‡¶åŠ è¼‰**: ä½¿ç”¨React.lazy()å»¶é²åŠ è¼‰éé—œéµçµ„ä»¶
2. **è¨˜æ†¶åŒ–**: ä½¿ç”¨useMemoå’ŒuseCallbacké¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
3. **è™›æ“¬åŒ–**: é•·åˆ—è¡¨ä½¿ç”¨è™›æ“¬åŒ–æŠ€è¡“
4. **åœ–ç‰‡å„ªåŒ–**: åœ–ç‰‡å£“ç¸®å’Œæ‡¶åŠ è¼‰

### å¾Œç«¯å„ªåŒ–

1. **ç·©å­˜ç­–ç•¥**: Redisç·©å­˜å¸¸ç”¨AIéŸ¿æ‡‰
2. **æ‰¹é‡è™•ç†**: æ”¯æŒå¤šå€‹AIè«‹æ±‚ä¸¦è¡Œè™•ç†
3. **é€£æ¥æ± **: æ•¸æ“šåº«é€£æ¥æ± ç®¡ç†
4. **è² è¼‰å‡è¡¡**: æ™ºèƒ½é¸æ“‡æœ€ä½³AIæä¾›å•†

### ç›£æ§æŒ‡æ¨™

```typescript
// æ€§èƒ½ç›£æ§
const performanceMetrics = {
  messageResponseTime: 0,
  suggestionGenerationTime: 0,
  imageAnalysisTime: 0,
  errorRate: 0,
  userSatisfaction: 0
};

// è¨˜éŒ„æ€§èƒ½æŒ‡æ¨™
const recordMetric = (metric: string, value: number) => {
  performanceMetrics[metric] = value;
  // ç™¼é€åˆ°ç›£æ§ç³»çµ±
  analyticsService.track('ai_performance', { metric, value });
};
```

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ç’°å¢ƒé…ç½®

```bash
# å®‰è£ä¾è³´
npm install

# ç’°å¢ƒè®Šé‡é…ç½®
cp .env.example .env
# ç·¨è¼¯ .env æ–‡ä»¶ï¼Œé…ç½®AIæä¾›å•†APIå¯†é‘°

# æ§‹å»ºæ‡‰ç”¨
npm run build

# å•Ÿå‹•æœå‹™
npm start
```

### Dockeréƒ¨ç½²

```dockerfile
# Dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .

EXPOSE 3000

CMD ["npm", "start"]
```

### ç›£æ§é…ç½®

```yaml
# prometheus.yml
scrape_configs:
  - job_name: 'ai-chat-service'
    static_configs:
      - targets: ['localhost:3000']
    metrics_path: '/metrics'
    scrape_interval: 15s
```

## ğŸ“š åƒè€ƒæ–‡æª”

- [React Native å®˜æ–¹æ–‡æª”](https://reactnative.dev/)
- [Redux Toolkit æ–‡æª”](https://redux-toolkit.js.org/)
- [Expo SDK æ–‡æª”](https://docs.expo.dev/)
- [OpenAI API æ–‡æª”](https://platform.openai.com/docs/)
- [Claude API æ–‡æª”](https://docs.anthropic.com/)

---

**æœ€å¾Œæ›´æ–°**: 2024-12-19  
**ç‰ˆæœ¬**: 1.0.0  
**ç‹€æ…‹**: æŠ€è¡“æ–‡æª”å®Œæˆ âœ…
